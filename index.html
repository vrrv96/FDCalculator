<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Fixed Deposit Interest Calculator</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      background: #eef0f5;
    }
    .container {
      display: flex;
      flex-direction: row;
      min-height: 92vh;
      margin: 20px 220px 20px 220px;
      border: 2px solid #0077b6; 
      border-radius: 12px;
      background: #fff;
      box-sizing: border-box;
      box-shadow: 0 2px 12px #b0b0b0;
    }
    .input-panel {
      width: 45%;
      min-width: 300px;
      padding: 2em 0.2em 2em 4em;
      border-right: 1px solid #eee;
      box-sizing: border-box;
    }
    .output-panel {
      width: 55%;
      padding: 2em;
      box-sizing: border-box;
      display: flex;
      flex-direction: column;
    }
    h2 { 
      margin-top: 0; 
      text-align: center; 
    }
    .form-label { 
      display: block; 
      margin-bottom: .5em; 
      font-weight: bold; 
    }
    .form-input { 
      width: 100%; 
      max-width: 400px;
      padding: .5em; 
      margin-bottom: 1.5em; 
      box-sizing: border-box;
    }
    button { 
      padding: .7em 1.5em; 
      font-size: 1em; 
      background: #0077b6;
      color: #fff;
      border: none;
      border-radius: 4px;
      display: block;
      margin: 0 auto;
      cursor: pointer;
    }
    .summary { 
      margin-bottom: 1.5em;
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 0.8em 2em;
    }
    .summary h3 {
      grid-column: 1 / -1;
      margin-bottom: 0.8em;
    }
    .summary p {
      margin: 0;
      white-space: nowrap;
    }
    .table-scroll {
      max-height: 320px;
      overflow-y: auto;
      border: 1px solid #e3e3e3;
      border-radius: 6px;
      background: #fafafd;
      box-shadow: 0 0 2px rgba(150,160,180,0.14);
    }
    table { 
      border-collapse: collapse; 
      width: 100%; 
      margin: 0; 
    }
    th, td { 
      padding: 0.6em 1em; 
      border: 1px solid #ccc; 
      text-align: center; 
      white-space: nowrap; 
    }
    .summary-row { 
      font-weight: bold; 
      background: #f3f7ff; 
    }
    h3 {
      text-align: center;
    }
    /* Disclaimer Popup Styles */
    .disclaimer-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 1000;
    }
    .disclaimer-popup {
      background: #fff;
      border-radius: 8px;
      padding: 2em;
      max-width: 600px;
      width: 90%;
      max-height: 80vh;
      overflow-y: auto;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
    }
    .disclaimer-popup h3 {
      margin-top: 0;
      color: #0077b6;
    }
    .disclaimer-popup p {
      margin: 1em 0;
      line-height: 1.5;
    }
    .disclaimer-popup button {
      margin-top: 1em;
    }
    /* Mobile layout */
    @media (max-width: 768px) {
      .container {
        flex-direction: column;
        margin: 10px;
        min-height: auto;
      }
      .input-panel {
        width: 100%;
        border-right: none;
        border-bottom: 1px solid #eee;
        padding: 1.5em;
      }
      .output-panel {
        width: 100%;
        padding: 1.5em;
      }
      .form-input {
        max-width: 100%;
      }
      .summary {
        grid-template-columns: 1fr;
        gap: 0.5em;
      }
      .table-scroll {
        max-height: none;
      }
      .disclaimer-popup {
        width: 95%;
        padding: 1.5em;
      }
    }
    @media (max-width: 1200px) {
      .container {
        margin: 15px;
      }
      .input-panel {
        min-width: 250px;
        padding: 1.5em;
      }
      .output-panel {
        padding: 1.5em;
      }
    }
  </style>
</head>
<body onload="load()">
  <div class="disclaimer-overlay" id="disclaimerOverlay">
    <div class="disclaimer-popup">
      <h3>Disclaimer</h3>
      <p>The Fixed Deposit Calculator is provided for informational and educational purposes only. It is designed to estimate the interest and maturity amount of a fixed deposit based on user-provided inputs such as principal, interest rate, dates, and tax rate. The calculations are based on standard financial formulas and assumptions, but they may not account for all real-world variables, such as changes in interest rates, bank-specific policies, or additional taxes and fees.</p>
      <p>This tool is not intended to provide financial, investment, or tax advice. Users should consult with a qualified financial advisor or professional before making any financial decisions. The developers and contributors of this tool are not responsible for any errors, inaccuracies, or omissions in the calculations, nor for any financial losses or damages resulting from the use of this tool.</p>
      <p>Use of the Fixed Deposit Calculator is at your own risk. Always verify results with your financial institution or advisor before taking any actions based on the tool’s output.</p>
      <button onclick="closeDisclaimer()">Close</button>
    </div>
  </div>
  <div class="container">
    <div class="input-panel">
      <h2>FD Calculator</h2>
      <label class="form-label" for="principal">Principal</label>
      <input class="form-input" type="number" id="principal" min="0" value="100000"/>

      <label class="form-label" for="rate">Interest Rate (%)</label>
      <input class="form-input" type="number" id="rate" step="0.01" min="0" value="5.1"/>

      <label class="form-label" for="years">Years</label>
      <input class="form-input" type="number" id="years" min="0" value="1"/>

      <label class="form-label" for="months">Months</label>
      <input class="form-input" type="number" id="months" min="0" max="11" value="0"/>

      <label class="form-label" for="start">Start Date</label>
      <input class="form-input" type="date" id="start" />

      <label class="form-label" for="tax">Tax deduction at source (TDS) Rate (%)</label>
      <input class="form-input" type="number" id="tax" step="0.01" min="0" value="10"/>

      <button onclick="calculateFD()">Calculate</button>
    </div>
    <div class="output-panel" id="output"></div>
    
  </div><p style="margin-top:-12px;"><center><a href=# onclick="showDisclaimer()">Disclaimer</a></center></p>
  <script>
    function load() { 
      document.getElementById("start").value = new Date().toISOString().slice(0, 10); 
      document.getElementById("disclaimerOverlay").style.display = "flex";
    }
    function closeDisclaimer() {
      document.getElementById("disclaimerOverlay").style.display = "none";
    }
    function showDisclaimer() {
      document.getElementById("disclaimerOverlay").style.display = "flex";
    }
    function pad(num) { return num.toString().padStart(2, '0'); }
    function lastDayOfMonth(date) {
      let dt = new Date(date.getFullYear(), date.getMonth() + 1, 0);
      return dt.getDate();
    }
    function getFinYear(date) {
      const y = date.getFullYear(), m = date.getMonth() + 1;
      if (m > 3) return `${y}-${y+1}`;
      else return `${y-1}-${y}`;
    }
    function calculateFD() {
      let p = parseFloat(document.getElementById('principal').value);
      let r = parseFloat(document.getElementById('rate').value);
      let years = parseInt(document.getElementById('years').value);
      let months = parseInt(document.getElementById('months').value) || 0;
      let startDate = document.getElementById('start').value;
      let tax = parseFloat(document.getElementById('tax').value) || 0;

      if (!p || !r || (!years && !months) || !startDate) {
        document.getElementById("output").innerHTML = "<b style='color:red'>Please fill all fields correctly.</b>";
        return;
      }

      let start = new Date(startDate);
      let end = new Date(start);
      end.setFullYear(end.getFullYear() + years);
      end.setMonth(end.getMonth() + months);

      let mstart = new Date(start), mend, int_accrued = 0, p1 = p;
      let mint = r / (12 * 100);
      let total_tds = 0, total_interest_gross = 0;
      let int_by_year = {}, tds_by_year = {};

      mend = new Date(mstart);
      mend.setDate(lastDayOfMonth(mstart));
      while (mend.getTime() <= end.getTime()) {
        let eff_days = (mend - mstart) / (1000 * 3600 * 24) + 1;
        let month_days = lastDayOfMonth(mstart);
        let intr = mint * p1 * (eff_days / month_days) / (month_days - 1);
        if ( mstart.getDate() == 1 && mend.getDate() == month_days ) {
            intr = mint * p1;
        } else if ( mstart.getDate() == 1 ) {
            intr = mint * p1 * (mend.getDate() - mstart.getDate()) / (month_days - 1);
        } else if ( mend.getDate() == month_days ) {
            intr = mint * p1 * (mend.getDate() - mstart.getDate()) / (month_days - 1);
        } else {
            intr = mint * p1 * (mend.getDate() - mstart.getDate()) / (month_days - 1);
        }
        total_interest_gross += intr;
        let tds = intr * tax / 100;
        let intr_after_tax = intr - tds;
        int_accrued += intr_after_tax;
        total_tds += tds;
        let fy = getFinYear(mend);
        int_by_year[fy] = (int_by_year[fy] || 0) + intr_after_tax;
        tds_by_year[fy] = (tds_by_year[fy] || 0) + tds;
        let period = (mend.getMonth() - start.getMonth());
        if ((period % 3 === 0 && mend.getDate() === start.getDate())|| mend.getTime() === end.getTime()) {
          p1 += int_accrued;
          int_accrued = 0;
        }
        let nextMonthDate = new Date(mend);
        nextMonthDate.setDate(1);
        nextMonthDate.setMonth(nextMonthDate.getMonth() + 1)
        if (mend.getTime() === end.getTime()) {
            break;
        } else if (mend.getDate() < lastDayOfMonth(mstart) && (mend.getMonth() - start.getMonth()) % 3 == 0) {
            mstart = new Date(mend);
            mend.setDate(lastDayOfMonth(mstart));
        } else if ((nextMonthDate.getMonth() - start.getMonth()) % 3 == 0) {
            nextMonthDate.setDate(1);
            mstart = new Date(nextMonthDate);
            mend = new Date(mstart)
            mend.setDate(lastDayOfMonth(mstart));
            mend.setDate(start.getDate());
        } else {
            mstart.setDate(1);
            mstart.setMonth(mstart.getMonth() + 1);
            mend = new Date(mstart);
            mend.setDate(lastDayOfMonth(mstart));
        }
        if ( mend.getTime() > end.getTime() && mstart.getTime() < end.getTime() ) {
            mend = new Date(end);
        }
      }
      var options = { year: 'numeric', month: 'short', day: 'numeric' };
      let maturity = p1;
      let total_interest = maturity - p;
      let total_interest_with_tds = total_interest + total_tds;
      let outHtml = `
        <div class="summary">
          <h3>Summary</h3>
          <p><b>Maturity Value:</b> ₹${maturity.toFixed(2)}</p>
          <p><b>Maturity Date:</b> ${end.toLocaleDateString("en-US", options)}</span></p>
          <p><b>Total Interest (Net):</b> ₹${total_interest.toFixed(2)}</p>
          <p><b>Total TDS:</b> ₹${total_tds.toFixed(2)}</p>
          <p><b>Total Interest + TDS:</b> ₹${total_interest_with_tds.toFixed(2)}</p>
        </div>
          <h3 style="margin-top:-4px;">Interest by FY</h3>
        <div class="table-scroll">
          <table><thead><tr><th>Financial Year</th><th>Interest (After Tax)</th><th>TDS</th></tr></thead><tbody>
      `;
      let total_fy_int = 0;
      for (let fy in int_by_year) {
        total_fy_int += int_by_year[fy];
        outHtml += `<tr>
          <td>${fy}</td>
          <td>₹${int_by_year[fy].toFixed(2)}</td>
          <td>₹${tds_by_year[fy].toFixed(2)}</td>
        </tr>`;
      }
      outHtml += `<tr class='summary-row'>
        <th>Total</th>
        <th>₹${total_fy_int.toFixed(2)}</th>
        <th>₹${total_tds.toFixed(2)}</th>
      </tr></tbody></table></div>`;
      document.getElementById("output").innerHTML = outHtml;
    }
  </script>
</body>
</html>
